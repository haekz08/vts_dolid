(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63b1152d"],{e47e:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("server-side-paginated-table",{ref:"displayTable",attrs:{fields:t.table_settings.fields,api_url:t.table_settings.api_url,delete_url:t.table_settings.delete_url,top_right_btn_redirect:!1}}),a("b-modal",{attrs:{centered:"",size:"xl","body-class":"p-0","hide-footer":!0,"hide-header":!0},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[a("delivery-modal",{attrs:{material_receive:t.material_receive},on:{save:t.save}})],1)],1)},s=[],r=a("56d7"),o=a("73e4"),l=a("86db"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"card bg-light mb-0"},[a("div",{staticClass:"card-header bg-dark text-white d-flex justify-content-between align-items-center"},[a("h6",{staticClass:"mb-0"},[a("font-awesome-icon",{attrs:{icon:"plus-circle"}}),t._v(" Material Purchase")],1)]),a("div",{staticClass:"card-body bg-white position-relative"},[t.is_saving?a("b-row",{staticClass:"loader",attrs:{"align-v":"center"}},[a("b-col",[a("b-spinner"),a("br"),a("br"),a("strong",[t._v("Loading")])],1)],1):t._e(),a("b-form",{on:{submit:function(e){return e.preventDefault(),t.save(e)}}},[a("b-row",{staticClass:"m-0 mb-3"},[a("b-col",{staticClass:"text-center p-2 bg-info text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h2 mb-0",attrs:{icon:"map-marker"}})],1),a("b-col",{staticClass:"p-2 bg-white d-flex align-items-center border"},[a("div",[a("h6",{staticClass:"mb-0 text-muted"},[t._v("Delivery Number")]),a("h2",{staticClass:"mb-0"},[a("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.editable&&(t.material_delivery_modal=!0)}}},["-1"==t.form.material_delivery_id?a("strong",[t._v("....")]):a("strong",[t._v(t._s(t.form.material_delivery.delivery_number))])])])])])],1),a("b-row",{staticClass:"m-0 mb-3"},[a("b-col",{staticClass:"p-0 pr-1"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-dark text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"calendar"}})],1),a("b-col",{staticClass:"p-2 bg-light"},[a("small",{staticClass:"text-muted"},[t._v("Transaction Date")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.transaction_date,expression:"form.transaction_date"}],staticClass:"form-control",attrs:{type:"date",placeholder:"Transaction Date",required:""},domProps:{value:t.form.transaction_date},on:{input:function(e){e.target.composing||t.$set(t.form,"transaction_date",e.target.value)}}})])],1)],1),a("b-col",{staticClass:"p-0 pl-1"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-dark text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"list"}})],1),a("b-col",{staticClass:"p-2 bg-light"},[a("small",{staticClass:"text-muted"},[t._v("Reference Number")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.reference_number,expression:"form.reference_number"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Reference Number",required:""},domProps:{value:t.form.reference_number},on:{input:function(e){e.target.composing||t.$set(t.form,"reference_number",e.target.value)}}})])],1)],1)],1),a("b-row",{staticClass:"m-0 mb-3"},[a("b-col",{staticClass:"p-0 pr-1"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-dark text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"check-circle"}})],1),a("b-col",{staticClass:"p-2 bg-light"},[a("small",{staticClass:"text-muted"},[t._v("Remarks")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.remarks,expression:"form.remarks"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Remarks",required:""},domProps:{value:t.form.remarks},on:{input:function(e){e.target.composing||t.$set(t.form,"remarks",e.target.value)}}})])],1)],1),a("b-col",{staticClass:"p-0 pl-1"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-success text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"check-circle"}})],1),a("b-col",{staticClass:"p-2 bg-light"},[a("small",{staticClass:"text-muted"},[t._v("Total Received Amount")]),a("input",{directives:[{name:"model",rawName:"v-model",value:"P "+t.total_received.toLocaleString("en-US",{minimumFractionDigits:2}),expression:"'P '+total_received.toLocaleString('en-US',{ minimumFractionDigits: 2 })"}],staticClass:"form-control text-right bg-white",attrs:{type:"text",placeholder:"Total Delivery Amount",required:"",readonly:""},domProps:{value:"P "+t.total_received.toLocaleString("en-US",{minimumFractionDigits:2})},on:{input:function(e){e.target.composing||t.$set("P "+t.total_received,"toLocaleString('en-US',{ minimumFractionDigits: 2 })",e.target.value)}}})]),a("b-col",{staticClass:"text-center p-1 bg-danger text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"times-circle"}})],1),a("b-col",{staticClass:"p-2 bg-light"},[a("small",{staticClass:"text-muted"},[t._v("Total Rejected Amount")]),a("input",{directives:[{name:"model",rawName:"v-model",value:"P "+t.total_rejected.toLocaleString("en-US",{minimumFractionDigits:2}),expression:"'P '+total_rejected.toLocaleString('en-US',{ minimumFractionDigits: 2 })"}],staticClass:"form-control text-right bg-white",attrs:{type:"text",placeholder:"Total Rejected Amount",required:"",readonly:""},domProps:{value:"P "+t.total_rejected.toLocaleString("en-US",{minimumFractionDigits:2})},on:{input:function(e){e.target.composing||t.$set("P "+t.total_rejected,"toLocaleString('en-US',{ minimumFractionDigits: 2 })",e.target.value)}}})])],1)],1)],1),a("div",{staticClass:"card bg-light mb-0 mt-3"},[a("div",{staticClass:"card-header bg-secondary d-flex justify-content-between align-items-center"},[a("h6",{staticClass:"mb-0"},[a("font-awesome-icon",{attrs:{icon:"list"}}),t._v(" Materials")],1),t.editable?a("b-button",{attrs:{variant:"dark",size:"sm"},on:{click:function(e){t.material_modal=!0}}},[a("font-awesome-icon",{attrs:{icon:"plus"}}),t._v(" Add Material ")],1):t._e()],1),a("div",{staticClass:"card-body bg-white position-relative p-2"},[a("table",{staticClass:"table border mb-0"},[a("thead",{staticClass:"bg-light text-dark"},[a("tr",[a("th",{attrs:{scope:"col"}},[t._v("Material")]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Price")]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Qty Received")]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Qty Rejected")]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Total Received")]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Total Rejected")]),t.editable?a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Action ")]):t._e()])]),a("tbody",t._l(t.form.material_receiving_details,(function(e,i){return a("tr",[a("th",{attrs:{scope:"row"}},[t._v(t._s(e.material.name))]),a("td",[a("b-form-input",{attrs:{type:"number",step:"any",min:"1",required:""},model:{value:e.price,callback:function(a){t.$set(e,"price",a)},expression:"material_delivery_detail.price"}})],1),a("td",[a("b-form-input",{attrs:{type:"number",step:"any",min:"1",required:""},model:{value:e.qty_received,callback:function(a){t.$set(e,"qty_received",a)},expression:"material_delivery_detail.qty_received"}})],1),a("td",[a("b-form-input",{attrs:{type:"number",step:"any",min:"1",required:""},model:{value:e.qty_rejected,callback:function(a){t.$set(e,"qty_rejected",a)},expression:"material_delivery_detail.qty_rejected"}})],1),a("td",{staticClass:"text-right"},[a("number-format-component",{attrs:{input_value:Number(e.total_received)}})],1),a("td",{staticClass:"text-right"},[a("number-format-component",{attrs:{input_value:Number(e.total_rejected)}})],1),t.editable?a("td",{staticClass:"text-center"},[a("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){return t.deleteMaterial(i)}}},[a("font-awesome-icon",{attrs:{icon:"minus-circle"}}),t._v(" Remove")],1)],1):t._e()])})),0),a("tfoot",{staticClass:"bg-light text-dark"},[a("tr",[a("th",{staticClass:"text-right",attrs:{scope:"col",colspan:"4"}},[t._v("TOTAL")]),a("th",{staticClass:"text-right",attrs:{scope:"col"}},[a("number-format-component",{attrs:{input_value:Number(t.total_received)}})],1),a("th",{staticClass:"text-right",attrs:{scope:"col"}},[a("number-format-component",{attrs:{input_value:Number(t.total_rejected)}})],1),t.editable?a("th",{staticClass:"text-center",attrs:{scope:"col"}}):t._e()])])])])]),t.editable?a("div",{staticClass:"text-right mt-3"},[a("b-button",{attrs:{type:"submit",variant:"dark",size:"sm"}},[a("font-awesome-icon",{attrs:{icon:"save"}}),t._v(" Save")],1)],1):t._e()],1)],1)]),a("b-modal",{attrs:{centered:"",size:"lg","body-class":"p-0","hide-footer":!0,"hide-header":!0},model:{value:t.material_delivery_modal,callback:function(e){t.material_delivery_modal=e},expression:"material_delivery_modal"}},[a("material-delivery-modal",{on:{select:t.selectDeliveryNumber}})],1),a("b-modal",{attrs:{centered:"",size:"lg","body-class":"p-0","hide-footer":!0,"hide-header":!0},model:{value:t.material_modal,callback:function(e){t.material_modal=e},expression:"material_modal"}},[a("material-modal",{on:{select:t.selectMaterial}})],1)],1)},n=[],d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"card bg-light mb-0"},[a("div",{staticClass:"card-header bg-dark text-white d-flex justify-content-between align-items-center"},[a("h6",{staticClass:"mb-0"},[a("font-awesome-icon",{attrs:{icon:"search"}}),t._v(" Material Delivery Search")],1)]),a("div",{staticClass:"card-body bg-white position-relative p-2"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-success text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"search"}})],1),a("b-col",{staticClass:"p-2 bg-white border"},[a("b-form-input",{attrs:{type:"text",debounce:"500",placeholder:"Search...",autocomplete:"off"},model:{value:t.search_key,callback:function(e){t.search_key=e},expression:"search_key"}})],1)],1),a("div",{staticClass:"position-relative"},[t.results.length>0?[t.is_saving?a("b-row",{staticClass:"loader",attrs:{"align-v":"center"}},[a("b-col",[a("b-spinner"),a("br"),a("br"),a("strong",[t._v("Loading")])],1)],1):t._e(),t._l(t.results,(function(e){return a("div",{staticClass:"card bg-light mb-0 mt-2"},[a("div",{staticClass:"card-header bg-secondary text-dark d-flex justify-content-between align-items-center"},[a("h6",{staticClass:"mb-0"},[a("font-awesome-icon",{attrs:{icon:"map-marker"}}),t._v(" "+t._s(e.starting_inventory.project_location_structure_item.project_location_structure.project_location.project.title))],1)]),a("div",{staticClass:"card-body bg-light position-relative p-2"},[a("b-row",{staticClass:"m-0 mb-2"},[a("b-col",{staticClass:"text-center p-2 bg-info text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h2 mb-0",attrs:{icon:"map-marker"}})],1),a("b-col",{staticClass:"p-2 bg-white d-flex align-items-center border"},[a("div",[a("h6",{staticClass:"mb-0 text-muted"},[t._v("Delivery Number")]),a("h2",{staticClass:"mb-0"},[a("a",{attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.viewDetails(e)}}},[a("strong",{on:{click:function(a){return t.viewDetails(e)}}},[t._v(t._s(e.delivery_number))])])])])])],1),a("div",{staticClass:"card-group mb-0"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-block p-3"},[a("div",{staticClass:"h1 text-muted text-right mb-2"},[a("font-awesome-icon",{staticClass:"text-info",attrs:{icon:"list"}})],1),a("div",{staticClass:"h5 mb-0"},[t._v(t._s(e.starting_inventory.project_location_structure_item.project_location_structure.project_location.description))]),a("small",{staticClass:"text-muted text-uppercase font-weight-bold"},[t._v("location")]),t._m(0,!0)])]),a("div",{staticClass:"card"},[a("div",{staticClass:"card-block p-3"},[a("div",{staticClass:"h1 text-muted text-right mb-2"},[a("font-awesome-icon",{staticClass:"text-success",attrs:{icon:"list"}})],1),a("div",{staticClass:"h5 mb-0"},[t._v(t._s(e.starting_inventory.project_location_structure_item.project_location_structure.description))]),a("small",{staticClass:"text-muted text-uppercase font-weight-bold"},[t._v("structure")]),t._m(1,!0)])]),a("div",{staticClass:"card"},[a("div",{staticClass:"card-block p-3"},[a("div",{staticClass:"h1 text-muted text-right mb-2"},[a("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:"list"}})],1),a("div",{staticClass:"h5 mb-0"},[t._v(t._s(e.starting_inventory.project_location_structure_item.description))]),a("small",{staticClass:"text-muted text-uppercase font-weight-bold"},[t._v("item")]),t._m(2,!0)])])]),a("div",{staticClass:"text-right mt-2"},[a("b-button",{attrs:{type:"submit",variant:"dark",size:"sm"},on:{click:function(a){return t.select(e)}}},[a("font-awesome-icon",{attrs:{icon:"check"}}),t._v(" SELECT")],1)],1)],1)])}))]:t._e()],2)],1)]),a("b-modal",{attrs:{centered:"",size:"xl","body-class":"p-0","hide-footer":!0,"hide-header":!0},model:{value:t.details_modal,callback:function(e){t.details_modal=e},expression:"details_modal"}},[a("modal",{attrs:{material_delivery:t.material_delivery}})],1)],1)},m=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"progress progress-xs mt-1 mb-0"},[a("div",{staticClass:"progress-bar bg-info",staticStyle:{width:"100%"},attrs:{role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"progress progress-xs mt-1 mb-0"},[a("div",{staticClass:"progress-bar bg-success",staticStyle:{width:"100%"},attrs:{role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"progress progress-xs mt-1 mb-0"},[a("div",{staticClass:"progress-bar bg-warning",staticStyle:{width:"100%"},attrs:{role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"}})])}],u=a("fe71"),_={mixins:[o["a"]],components:{NumberFormatComponent:l["a"],Modal:u["a"]},data:function(){return{is_saving:!1,search_key:"",results:[],details_modal:!1,material_delivery:{}}},watch:{search_key:{immediate:!0,handler:function(){""!=this.search_key&&this.getProjects()}}},created:function(){},methods:{getProjects:function(){var t=this;this.is_saving=!0,this.axios.get("inventory/deliveries/search?search="+this.search_key).then((function(e){t.results=e.data,t.is_saving=!1})).catch((function(t){return console.log(t)}))},select:function(t){this.$emit("select",t)},viewDetails:function(t){var e=JSON.parse(JSON.stringify(t));e.project_location_structure_item=e.starting_inventory.project_location_structure_item,e.transaction_date=e.transaction_date.default,e.project_location_structure_item_id=e.starting_inventory.project_location_structure_item_id,this.material_delivery=e,this.details_modal=!0}}},p=_,v=a("2877"),b=Object(v["a"])(p,d,m,!1,null,null,null),h=b.exports,f=a("1c5b"),g={mixins:[o["a"]],components:{NumberFormatComponent:l["a"],MaterialModal:f["a"],MaterialDeliveryModal:h},props:{material_receive:{type:Object,default:function(){},required:!1}},data:function(){return{is_saving:!1,material_delivery_modal:!1,material_modal:!1,form:{id:-1,transaction_date:"",reference_number:"",material_delivery:{},material_delivery_id:-1,material_receiving_details:[],total_received:0,total_rejected:0},editable:!0}},watch:{material_receive:{immediate:!0,handler:function(){"undefined"!=typeof this.material_receive.id&&(this.form=this.material_receive)}},form:{immediate:!0,deep:!0,handler:function(){this.editable=-1==this.form.id,this.form.material_receiving_details.forEach((function(t,e){t.total_received=t.price*t.qty_received,t.total_rejected=t.price*t.qty_rejected}))}}},computed:{total_received:function(){return this.form.material_receiving_details.reduce((function(t,e){return t+Number(e.total_received)}),0)},total_rejected:function(){return this.form.material_receiving_details.reduce((function(t,e){return t+Number(e.total_rejected)}),0)}},created:function(){},methods:{save:function(){var t=this;return-1==this.form.material_delivery_id?(this.swal_transaction_error_data.text="Please select a purchase order.",void this.swalRequestError()):this.form.material_receiving_details.length<=0?(this.swal_transaction_error_data.text="Please select a material/s.",void this.swalRequestError()):void this.swalConfirmSubmit((function(e){t.editable&&e.value&&(t.is_saving=!0,t.form.total_received=t.total_received,t.form.total_rejected=t.total_rejected,t.axios.post("inventory/receivings/save",t.form).then((function(e){t.swalTransactionCompleted(),t.is_saving=!1,t.$emit("save")})).catch((function(e){t.swal_transaction_error_data.text=e.response.data,t.swalRequestError(),t.is_saving=!1})))}))},selectDeliveryNumber:function(t){this.form.material_delivery=t,this.form.material_delivery_id=t.id,this.material_delivery_modal=!1},selectMaterial:function(t){if(this.form.material_receiving_details.find((function(e){return e.material_id===t.id})))return this.swal_transaction_error_data.text="Material already exist.",void this.swalRequestError();var e={id:-1,material:t,material_receiving_id:-1,material_id:t.id,qty_received:1,qty_rejected:0,price:0,total_received:0,total_rejected:0};this.form.material_receiving_details.push(e),this.material_modal=!1},deleteMaterial:function(t){var e=this;this.swalConfirmDelete((function(a){a.value&&e.form.material_receiving_details.splice(t,1)}))}}},C=g,y=Object(v["a"])(C,c,n,!1,null,null,null),x=y.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"card bg-light mb-3"},[a("div",{staticClass:"card-header bg-dark text-white"},[a("b-row",[a("b-col",[t.loading?a("div",[a("strong",[t._v(" Fetching result... ")])]):a("div",[a("font-awesome-icon",{attrs:{icon:"database"}}),a("strong",[t._v(" "+t._s(t.list.total)+" ")]),a("small",[t._v("Result/s found")])],1)]),a("b-col",{staticClass:"text-right"},[t.top_right_btn_redirect?a("router-link",{attrs:{to:"add"}},[a("b-button",{attrs:{variant:"secondary",size:"sm"}},[a("font-awesome-icon",{attrs:{icon:"plus"}}),t._v(" Add New Record ")],1)],1):a("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:t.clickTopRightBtn}},[a("font-awesome-icon",{attrs:{icon:"plus"}}),t._v(" Add New Record ")],1)],1)],1)],1),a("div",{staticClass:"card-body bg-white mb-0"},[a("b-row",{staticClass:"mb-3"},[a("b-col",{attrs:{sm:"2"}},[a("b-form-select",{attrs:{options:t.options,size:"sm"},on:{change:t.changeDisplayNo},model:{value:t.selected_display_no,callback:function(e){t.selected_display_no=e},expression:"selected_display_no"}})],1),a("b-col",{attrs:{sm:"6","offset-sm":"4"}},[a("b-input-group",[a("b-input-group-prepend",[a("b-input-group-text",{staticClass:"bg-dark text-white"},[a("font-awesome-icon",{attrs:{icon:"search"}})],1)],1),a("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Search",autocomplete:"off",size:"sm"},nativeOn:{keypress:function(e){return t.searching(e)},keyup:function(e){return t.search(e)}},model:{value:t.search_term,callback:function(e){t.search_term=e},expression:"search_term"}}),a("b-input-group-append",[a("b-button",{staticClass:"bg-dark text-white px-4",attrs:{variant:"dark",size:"sm",disabled:""==t.search_term},on:{click:t.clearSearch}},[a("font-awesome-icon",{attrs:{icon:"times"}})],1)],1)],1)],1)],1),a("b-table",{attrs:{selectable:"",selectedVariant:"info","select-mode":"single",dark:t.dark,hover:t.hover,striped:t.striped,bordered:t.bordered,fixed:t.fixed,responsive:"sm",items:t.table_items,fields:t.captions,busy:t.loading,"show-empty":"","head-variant":"dark"},on:{"row-dblclicked":t.rowDbClicked},scopedSlots:t._u([{key:"cell(action)",fn:function(e){return[a("div",{staticClass:"text-center"},[a("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(a){return t.deleteRow(e.item.id)}}},[a("font-awesome-icon",{attrs:{icon:"minus-circle"}}),t._v(" Delete ")],1)],1)]}},{key:"cell(starting_inventory)",fn:function(e){return[a("div",{staticClass:"h5 mb-0"},[t._v(t._s(e.item.starting_inventory.project_location_structure_item.project_location_structure.project_location.project.title))]),a("div",{staticClass:"small text-muted"},[t._v(" "+t._s(e.item.starting_inventory.project_location_structure_item.project_location_structure.project_location.description)+" | "+t._s(e.item.starting_inventory.project_location_structure_item.project_location_structure.description)+" | "+t._s(e.item.starting_inventory.project_location_structure_item.description)+" ")])]}}])},[a("div",{staticClass:"text-center my-2",attrs:{slot:"table-busy"},slot:"table-busy"},[a("br"),a("b-spinner",{staticClass:"align-middle",attrs:{small:""}}),a("br"),a("br"),a("strong",[t._v("Loading")])],1)]),t.list.total>0?a("nav",[a("b-pagination",{staticClass:"mb-0",attrs:{disabled:t.loading,align:"right","total-rows":t.total_rows,"per-page":t.per_page},on:{input:t.getAll},model:{value:t.list.current_page,callback:function(e){t.$set(t.list,"current_page",e)},expression:"list.current_page"}})],1):t._e()],1)])])},k=[],j={name:"server-side-paginated-table",inheritAttrs:!1,mixins:[o["a"]],props:{hover:{type:Boolean,default:!0},striped:{type:Boolean,default:!0},bordered:{type:Boolean,default:!0},small:{type:Boolean,default:!0},fixed:{type:Boolean,default:!0},fields:{type:[Array,Object],default:function(){return[]}},dark:{type:Boolean,default:!1},api_url:{type:String,required:!0},delete_url:{type:String,required:!0},top_right_btn:{type:String,default:"",required:!1},top_right_btn_redirect:{type:Boolean,default:!0,required:!1}},data:function(){return{selected:[],list:{data:[],from:1,to:0,current_page:1,total:0,per_page:1},result:[],loading:!0,searchTimeout:function(){return{type:Function,default:function(){return{}}}},search_term:"",options:[{value:10,text:"Display 10 records"},{value:25,text:"Display 25 records"},{value:50,text:"Display 50 records"},{value:100,text:"Display 100 records"}],selected_display_no:10}},computed:{table_items:function(){return this.list.data},per_page:function(){return parseInt(this.list.per_page)},total_rows:function(){return parseInt(this.list.total)},captions:function(){return this.fields},total_selected:function(){return parseInt(this.selected.length)}},mounted:function(){this.getAll()},methods:{getAll:function(){var t=this;this.loading=!0,this.axios.get(this.api_url+"?page="+this.list.current_page+"&per_page="+this.selected_display_no+"&search="+this.search_term).then((function(e){var a=e.data;t.list=a,t.loading=!1})).catch((function(t){return console.log(t)}))},clickTopRightBtn:function(){r["bus"].$emit("serverSidePaginatedTableTopRightBtnClicked")},rowDbClicked:function(t){r["bus"].$emit("serverSidePaginatedTableDbClick",t)},searching:function(){this.loading=!0,clearTimeout(this.searchTimeout)},search:function(){var t=this;this.searchTimeout=setTimeout((function(){t.list.current_page=1,t.getAll(),clearTimeout(t.searchTimeout)}),1e3)},clearSearch:function(){this.search_term="",this.getAll()},changeDisplayNo:function(){this.loading=!0,this.list.current_page=1,this.getAll()},deleteRow:function(t){var e=this;this.swalConfirmDelete((function(a){a.value&&(e.loading=!0,e.axios.delete(e.delete_url,{data:{id:t}}).then((function(t){e.getAll(),e.swal_transaction_completed_data.text="Record successfully deleted.",e.swalTransactionCompleted(),e.loading=!1})).catch((function(t){e.swalRequestError(),e.loading=!1})))}))}}},S=j,D=Object(v["a"])(S,w,k,!1,null,null,null),N=D.exports,q={mixins:[o["a"]],components:{NumberFormatComponent:l["a"],DeliveryModal:x,ServerSidePaginatedTable:N},data:function(){return{is_saving:!1,modal:!1,result:[],table_settings:{api_url:"inventory/receivings/all",delete_url:"inventory/receivings/delete",fields:[{key:"starting_inventory",label:"Project"},{key:"transaction_date.other_formats.format_1",label:"Date"},{key:"reference_number",label:"Reference Number"},{key:"material_delivery.delivery_number",label:"Delivery Number"},{key:"action",label:"Action",class:"text-center"}]},material_receive:{}}},created:function(){var t=this;r["bus"].$on("serverSidePaginatedTableTopRightBtnClicked",(function(e){t.modal=!0})),r["bus"].$on("serverSidePaginatedTableDbClick",(function(e){var a=JSON.parse(JSON.stringify(e));a.material_delivery=a.material_delivery,a.material_delivery_id=a.material_delivery.id,a.transaction_date=a.transaction_date.default,t.material_receive=a,t.modal=!0}))},methods:{get:function(){this.$refs.displayTable.getAll(),this.modal=!1},save:function(){this.get()}}},P=q,T=Object(v["a"])(P,i,s,!1,null,null,null);e["default"]=T.exports},fe71:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"card bg-light mb-0"},[a("div",{staticClass:"card-header bg-dark text-white d-flex justify-content-between align-items-center"},[a("h6",{staticClass:"mb-0"},[a("font-awesome-icon",{attrs:{icon:"plus-circle"}}),t._v(" Material Delivery")],1)]),a("div",{staticClass:"card-body bg-white position-relative"},[t.is_saving?a("b-row",{staticClass:"loader",attrs:{"align-v":"center"}},[a("b-col",[a("b-spinner"),a("br"),a("br"),a("strong",[t._v("Loading")])],1)],1):t._e(),a("b-form",{on:{submit:function(e){return e.preventDefault(),t.save(e)}}},[a("b-row",{staticClass:"m-0 mb-3"},[a("b-col",{staticClass:"text-center p-2 bg-info text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h2 mb-0",attrs:{icon:"map-marker"}})],1),a("b-col",{staticClass:"p-2 bg-white d-flex align-items-center border"},[a("div",[a("h6",{staticClass:"mb-0 text-muted"},[t._v("Order Number")]),a("h2",{staticClass:"mb-0"},[a("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.editable&&(t.material_purchase_modal=!0)}}},["-1"==t.form.material_purchase_id?a("strong",[t._v("....")]):a("strong",[t._v(t._s(t.form.material_purchase.order_number))])])])])])],1),a("b-row",{staticClass:"m-0 mb-3"},[a("b-col",{staticClass:"p-0 pr-1"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-dark text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"calendar"}})],1),a("b-col",{staticClass:"p-2 bg-light"},[a("small",{staticClass:"text-muted"},[t._v("Transaction Date")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.transaction_date,expression:"form.transaction_date"}],staticClass:"form-control",attrs:{type:"date",placeholder:"Transaction Date",required:""},domProps:{value:t.form.transaction_date},on:{input:function(e){e.target.composing||t.$set(t.form,"transaction_date",e.target.value)}}})])],1)],1),a("b-col",{staticClass:"p-0 pl-1"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-dark text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"list"}})],1),a("b-col",{staticClass:"p-2 bg-light"},[a("small",{staticClass:"text-muted"},[t._v("Delivery Number")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.delivery_number,expression:"form.delivery_number"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Delivery Number",required:""},domProps:{value:t.form.delivery_number},on:{input:function(e){e.target.composing||t.$set(t.form,"delivery_number",e.target.value)}}})])],1)],1)],1),a("b-row",{staticClass:"m-0 mb-3"},[a("b-col",{staticClass:"p-0 pr-1"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-dark text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"check-circle"}})],1),a("b-col",{staticClass:"p-2 bg-light"},[a("small",{staticClass:"text-muted"},[t._v("Remarks")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.remarks,expression:"form.remarks"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Remarks",required:""},domProps:{value:t.form.remarks},on:{input:function(e){e.target.composing||t.$set(t.form,"remarks",e.target.value)}}})])],1)],1),a("b-col",{staticClass:"p-0 pl-1"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-dark text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"check-circle"}})],1),a("b-col",{staticClass:"p-2 bg-light"},[a("small",{staticClass:"text-muted"},[t._v("Total Delivery Amount")]),a("input",{directives:[{name:"model",rawName:"v-model",value:"P "+t.total.toLocaleString("en-US",{minimumFractionDigits:2}),expression:"'P '+total.toLocaleString('en-US',{ minimumFractionDigits: 2 })"}],staticClass:"form-control text-right bg-white",attrs:{type:"text",placeholder:"Total Delivery Amount",required:"",readonly:""},domProps:{value:"P "+t.total.toLocaleString("en-US",{minimumFractionDigits:2})},on:{input:function(e){e.target.composing||t.$set("P "+t.total,"toLocaleString('en-US',{ minimumFractionDigits: 2 })",e.target.value)}}})])],1)],1)],1),a("div",{staticClass:"card bg-light mb-0 mt-3"},[a("div",{staticClass:"card-header bg-secondary d-flex justify-content-between align-items-center"},[a("h6",{staticClass:"mb-0"},[a("font-awesome-icon",{attrs:{icon:"list"}}),t._v(" Materials")],1),t.editable?a("b-button",{attrs:{variant:"dark",size:"sm"},on:{click:function(e){t.material_modal=!0}}},[a("font-awesome-icon",{attrs:{icon:"plus"}}),t._v(" Add Material ")],1):t._e()],1),a("div",{staticClass:"card-body bg-white position-relative p-2"},[a("table",{staticClass:"table border mb-0"},[a("thead",{staticClass:"bg-light text-dark"},[a("tr",[a("th",{attrs:{scope:"col"}},[t._v("Material")]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Qty")]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Price")]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Total")]),t.editable?a("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Action ")]):t._e()])]),a("tbody",t._l(t.form.material_delivery_details,(function(e,i){return a("tr",[a("th",{attrs:{scope:"row"}},[t._v(t._s(e.material.name))]),a("td",[a("b-form-input",{attrs:{type:"number",step:"any",min:"1",required:""},model:{value:e.qty,callback:function(a){t.$set(e,"qty",a)},expression:"material_delivery_detail.qty"}})],1),a("td",[a("b-form-input",{attrs:{type:"number",step:"any",min:"1",required:""},model:{value:e.price,callback:function(a){t.$set(e,"price",a)},expression:"material_delivery_detail.price"}})],1),a("td",{staticClass:"text-right"},[a("number-format-component",{attrs:{input_value:Number(e.total)}})],1),t.editable?a("td",{staticClass:"text-center"},[a("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){return t.deleteMaterial(i)}}},[a("font-awesome-icon",{attrs:{icon:"minus-circle"}}),t._v(" Remove")],1)],1):t._e()])})),0),a("tfoot",{staticClass:"bg-light text-dark"},[a("tr",[a("th",{staticClass:"text-right",attrs:{scope:"col",colspan:"3"}},[t._v("TOTAL")]),a("th",{staticClass:"text-right",attrs:{scope:"col"}},[a("number-format-component",{attrs:{input_value:Number(t.total)}})],1),t.editable?a("th",{staticClass:"text-center",attrs:{scope:"col"}}):t._e()])])])])]),t.editable?a("div",{staticClass:"text-right mt-3"},[a("b-button",{attrs:{type:"submit",variant:"dark",size:"sm"}},[a("font-awesome-icon",{attrs:{icon:"save"}}),t._v(" Save")],1)],1):t._e()],1)],1)]),a("b-modal",{attrs:{centered:"",size:"lg","body-class":"p-0","hide-footer":!0,"hide-header":!0},model:{value:t.material_purchase_modal,callback:function(e){t.material_purchase_modal=e},expression:"material_purchase_modal"}},[a("material-purchase-modal",{on:{select:t.selectOrderNumber}})],1),a("b-modal",{attrs:{centered:"",size:"lg","body-class":"p-0","hide-footer":!0,"hide-header":!0},model:{value:t.material_modal,callback:function(e){t.material_modal=e},expression:"material_modal"}},[a("material-modal",{on:{select:t.selectMaterial}})],1)],1)},s=[],r=a("73e4"),o=a("86db"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"card bg-light mb-0"},[a("div",{staticClass:"card-header bg-dark text-white d-flex justify-content-between align-items-center"},[a("h6",{staticClass:"mb-0"},[a("font-awesome-icon",{attrs:{icon:"search"}}),t._v(" Material Purchase Search")],1)]),a("div",{staticClass:"card-body bg-white position-relative p-2"},[a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"text-center p-1 bg-success text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h3 mb-0",attrs:{icon:"search"}})],1),a("b-col",{staticClass:"p-2 bg-white border"},[a("b-form-input",{attrs:{type:"text",debounce:"500",placeholder:"Search...",autocomplete:"off"},model:{value:t.search_key,callback:function(e){t.search_key=e},expression:"search_key"}})],1)],1),a("div",{staticClass:"position-relative"},[t.results.length>0?[t.is_saving?a("b-row",{staticClass:"loader",attrs:{"align-v":"center"}},[a("b-col",[a("b-spinner"),a("br"),a("br"),a("strong",[t._v("Loading")])],1)],1):t._e(),t._l(t.results,(function(e){return a("div",{staticClass:"card bg-light mb-0 mt-2"},[a("div",{staticClass:"card-header bg-secondary text-dark d-flex justify-content-between align-items-center"},[a("h6",{staticClass:"mb-0"},[a("font-awesome-icon",{attrs:{icon:"map-marker"}}),t._v(" "+t._s(e.project_location_structure_item.project_location_structure.project_location.project.title))],1)]),a("div",{staticClass:"card-body bg-light position-relative p-2"},[a("b-row",{staticClass:"m-0 mb-2"},[a("b-col",{staticClass:"text-center p-2 bg-info text-white d-flex align-items-center justify-content-center",attrs:{cols:"1"}},[a("font-awesome-icon",{staticClass:"h2 mb-0",attrs:{icon:"map-marker"}})],1),a("b-col",{staticClass:"p-2 bg-white d-flex align-items-center border"},[a("div",[a("h6",{staticClass:"mb-0 text-muted"},[t._v("Order Number")]),a("h2",{staticClass:"mb-0"},[a("a",{attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.viewDetails(e)}}},[a("strong",{on:{click:function(a){return t.viewDetails(e)}}},[t._v(t._s(e.order_number))])])])])])],1),a("div",{staticClass:"card-group mb-0"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-block p-3"},[a("div",{staticClass:"h1 text-muted text-right mb-2"},[a("font-awesome-icon",{staticClass:"text-info",attrs:{icon:"list"}})],1),a("div",{staticClass:"h5 mb-0"},[t._v(t._s(e.project_location_structure_item.project_location_structure.project_location.description))]),a("small",{staticClass:"text-muted text-uppercase font-weight-bold"},[t._v("location")]),t._m(0,!0)])]),a("div",{staticClass:"card"},[a("div",{staticClass:"card-block p-3"},[a("div",{staticClass:"h1 text-muted text-right mb-2"},[a("font-awesome-icon",{staticClass:"text-success",attrs:{icon:"list"}})],1),a("div",{staticClass:"h5 mb-0"},[t._v(t._s(e.project_location_structure_item.project_location_structure.description))]),a("small",{staticClass:"text-muted text-uppercase font-weight-bold"},[t._v("structure")]),t._m(1,!0)])]),a("div",{staticClass:"card"},[a("div",{staticClass:"card-block p-3"},[a("div",{staticClass:"h1 text-muted text-right mb-2"},[a("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:"list"}})],1),a("div",{staticClass:"h5 mb-0"},[t._v(t._s(e.project_location_structure_item.description))]),a("small",{staticClass:"text-muted text-uppercase font-weight-bold"},[t._v("item")]),t._m(2,!0)])])]),a("div",{staticClass:"text-right mt-2"},[a("b-button",{attrs:{type:"submit",variant:"dark",size:"sm"},on:{click:function(a){return t.select(e)}}},[a("font-awesome-icon",{attrs:{icon:"check"}}),t._v(" SELECT")],1)],1)],1)])}))]:t._e()],2)],1)]),a("b-modal",{attrs:{centered:"",size:"xl","body-class":"p-0","hide-footer":!0,"hide-header":!0},model:{value:t.details_modal,callback:function(e){t.details_modal=e},expression:"details_modal"}},[a("modal",{attrs:{material_purchase:t.material_purchase}})],1)],1)},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"progress progress-xs mt-1 mb-0"},[a("div",{staticClass:"progress-bar bg-info",staticStyle:{width:"100%"},attrs:{role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"progress progress-xs mt-1 mb-0"},[a("div",{staticClass:"progress-bar bg-success",staticStyle:{width:"100%"},attrs:{role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"progress progress-xs mt-1 mb-0"},[a("div",{staticClass:"progress-bar bg-warning",staticStyle:{width:"100%"},attrs:{role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"}})])}],n=a("c50f"),d={mixins:[r["a"]],components:{NumberFormatComponent:o["a"],Modal:n["a"]},data:function(){return{is_saving:!1,search_key:"",results:[],details_modal:!1,material_purchase:{}}},watch:{search_key:{immediate:!0,handler:function(){""!=this.search_key&&this.getProjects()}}},created:function(){},methods:{getProjects:function(){var t=this;this.is_saving=!0,this.axios.get("inventory/purchases/search?search="+this.search_key).then((function(e){t.results=e.data,t.is_saving=!1})).catch((function(t){return console.log(t)}))},select:function(t){this.$emit("select",t)},viewDetails:function(t){var e=JSON.parse(JSON.stringify(t));e.project_location_structure_item=e.project_location_structure_item,e.transaction_date=e.transaction_date.default,e.project_location_structure_item_id=e.project_location_structure_item_id,this.material_purchase=e,this.details_modal=!0}}},m=d,u=a("2877"),_=Object(u["a"])(m,l,c,!1,null,null,null),p=_.exports,v=a("1c5b"),b={mixins:[r["a"]],components:{NumberFormatComponent:o["a"],MaterialModal:v["a"],MaterialPurchaseModal:p},props:{material_delivery:{type:Object,default:function(){},required:!1}},data:function(){return{is_saving:!1,material_purchase_modal:!1,material_modal:!1,form:{id:-1,transaction_date:"",delivery_number:"",material_purchase:{},material_purchase_id:-1,material_delivery_details:[],project_location_structure_item:{},project_location_structure_item_id:-1,total:0},editable:!0}},watch:{material_delivery:{immediate:!0,handler:function(){"undefined"!=typeof this.material_delivery.id&&(this.form=this.material_delivery)}},form:{immediate:!0,deep:!0,handler:function(){this.editable=-1==this.form.id,this.form.material_delivery_details.forEach((function(t,e){t.total=t.price*t.qty}))}}},computed:{total:function(){return this.form.material_delivery_details.reduce((function(t,e){return t+Number(e.total)}),0)}},created:function(){},methods:{save:function(){var t=this;return-1==this.form.material_purchase_id?(this.swal_transaction_error_data.text="Please select a purchase order.",void this.swalRequestError()):this.form.material_delivery_details.length<=0?(this.swal_transaction_error_data.text="Please select a material/s.",void this.swalRequestError()):void this.swalConfirmSubmit((function(e){t.editable&&e.value&&(t.is_saving=!0,t.form.total=t.total,t.axios.post("inventory/deliveries/save",t.form).then((function(e){t.swalTransactionCompleted(),t.is_saving=!1,t.$emit("save")})).catch((function(e){t.swal_transaction_error_data.text=e.response.data,t.swalRequestError(),t.is_saving=!1})))}))},selectOrderNumber:function(t){this.form.material_purchase=t,this.form.material_purchase_id=t.id,this.form.project_location_structure_item=t.project_location_structure_item,this.form.project_location_structure_item_id=t.project_location_structure_item.id,this.material_purchase_modal=!1},selectMaterial:function(t){if(this.form.material_delivery_details.find((function(e){return e.material_id===t.id})))return this.swal_transaction_error_data.text="Material already exist.",void this.swalRequestError();var e={id:-1,material:t,material_purchase_id:-1,material_id:t.id,qty:1,price:0,total:0};this.form.material_delivery_details.push(e),this.material_modal=!1},deleteMaterial:function(t){var e=this;this.swalConfirmDelete((function(a){a.value&&e.form.material_delivery_details.splice(t,1)}))}}},h=b,f=Object(u["a"])(h,i,s,!1,null,null,null);e["a"]=f.exports}}]);
//# sourceMappingURL=chunk-63b1152d.d060a130.js.map